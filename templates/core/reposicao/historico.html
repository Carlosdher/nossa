{% extends '../base.html'%}

{% block content %}
<section class="content-header">
    <h1>
      Usuários
      <small>it all starts here</small>
    </h1>
    <ol class="breadcrumb">
      <li><a href="{% url 'core:dashboard' %}"><i class="fa fa-dashboard"></i> Home</a></li>
      <li class="#">Historico</li>
    </ol>
    <div class="box-tools">
      <div class="input-group input-group-sm">

        <form method="get">
          {% csrf_token %}
          <div class="input-group-btn">
            <input class="form-control pull-left" placeholder="Search" type="text" name="name" id="name">
            <button type="submit" class="btn btn-default" name="search" id="search"><i class="fa fa-search"></i></button>
          </div>
        </form>
      </div>

    </div>

</section>
  <!-- Main content -->
  <section class="content">
  <div class="wrapper">
  <div class="box-body table-responsive no-padding">
    <table class="table table-hover">
            <tr>
              <th>Professor</th>
              <th>Matricula</th>
              <th>Periodo da Falta</th>
              <th>Turma-Período</th>
              <th>Data de Reposicao</th>
              <th>Status</th>
            </tr>
            {%if request.user.is_staff%}
            {% for solicitation in solicitacao %}

            <tr>
                <td>{{ solicitation.usuario.first_name }} {{solicitation.usuario.last_name}}</td>
                <td>{{ solicitation.usuario.registration }}</td>
                <td>{% if solicitation.date_miss_start.day <= 9 %} 0{{solicitation.date_miss_start.day}}{% else %}{{solicitation.date_miss_start.day}}{% endif %}/{% if solicitation.date_miss_start.month <= 9 %}0{{solicitation.date_miss_start.month}}{% else %}{{solicitation.date_miss_start.month}}{% endif %}/{{solicitation.date_miss_start.year}} - {% if solicitation.date_miss_end.day <= 9 %} 0{{solicitation.date_miss_end.day}}{% else %} {{solicitation.date_miss_end.day}}{% endif %}/{% if solicitation.date_miss_end.month <= 9 %}0{{solicitation.date_miss_end.month}}{% else %}{{solicitation.date_miss_end.month}}{% endif %}/{{solicitation.date_miss_end.year}}</td>
                <td>{{solicitation.team}}</td>
                {% if Planejamento %}
                  {% for plannig in Planejamento %}
                    {% if plannig.solicitation == solicitation %}
                    <td>{{ plannig }}</td>
                    {% else %}
                      <td>---------</td>
                    {% endif %}
                  {% endfor %}
                {% else %}
                  <td>---------</td>
                {% endif %}
                {% for object in object_list %}
                    {% if object.solicitation == solicitation %}

                      {% if object.status == 4 %}

                          <td class="label label-success">Aprovada</td>

                      {% elif object.status == 0 %}

                        <td class="label label-danger">Negada</td>
                      {% else %}

                        <td class="label label-warning">Em Andamento</td>

                      {% endif %}
                    {% endif %}
                  {% endfor %}
                </tr>
              {% endfor %}
            {% else %}
              {% for solicitation in solicitacao %}
              {%if request.user.username == solicitation.usuario.username%}

              <tr>
                  <td>{{ solicitation.usuario.first_name }}{{solicitation.usuario.last_name}}</td>
                  <td>{{ solicitation.usuario.registration }}</td>
                  <td>{{solicitation.date_miss_start}} - {{solicitation.date_miss_end}}</td>
                  <td>{{solicitation.team}}</td>
                  {% if Planejamento %}
                    {% for plannig in Planejamento %}
                      {% if plannig.solicitation == solicitation %}
                      <td>{{ plannig }}</td>
                      {% else %}
                        <td>---------</td>
                      {% endif %}
                    {% endfor %}
                  {% else %}
                    <td>---------</td>
                  {% endif %}
                  {% for object in object_list %}
                      {% if object.solicitation == solicitation %}

                        {% if object.status == 4 %}

                            <td class="label label-success">Aprovada</td>

                        {% elif object.status == 0 %}

                          <td class="label label-danger">Negada</td>
                        {% else %}

                          <td class="label label-warning">Em Andamento</td>

                        {% endif %}
                      {% endif %}
                    {% endfor %}
                    {% endif %}
                  </tr>
                {% endfor %}

            {% endif %}

        </table>

      </div>
</div>
</div>
</section>
{% endblock %}
